---
layout: episode
title: "10: å–¬å–¬ escaping"
description: weak self podcast
date: 2019-09-29 22:30:00 +0800
categories: 
---
<iframe src="https://anchor.fm/weakself/embed/episodes/10--escaping-e5l7p6" height="102px" width="400px" frameborder="0" scrolling="no"></iframe>

æœ¬é›†ç«Ÿç„¶æœ‰äºº escapeï¼é‚£æˆ‘å€‘å°±é †å‹¢ä¾†å›æ‡‰èˆ‡ @escaping æœ‰é—œçš„ [#weakselfæŒ‘æˆ°è³½](https://twitter.com/hashtag/weakselfæŒ‘æˆ°è³½)å§ï¼ç‚ºä»€éº¼ Swift closure çš„ [weak self] è¦åŠ ä¸­æ‹¬è™Ÿå‘¢ï¼Ÿweakã€unowned ä½ åˆ†å¾—æ¸…æ¥šå·®åˆ¥å—ï¼Ÿä¸€èµ·ä¾†åƒèˆ‡æŒ‘æˆ°å§ã€‚

## weak self æŒ‘æˆ°è³½

* å°ç¶ çš„æŒ‘æˆ°[æ¨æ–‡](https://twitter.com/handkid/status/1174669625579032578?s=20)
* ä½•è¬‚ escapingã€nonescaping closure
* ä½•æ™‚ç”¨ weakã€unownedï¼Œæˆ–æ˜¯ä¸ç”¨

## Closure çš„è¡Œç‚º

* æ­é…æœç”¨çš„[ç¨‹å¼ç¯„ä¾‹](https://gist.github.com/pofat/0c5d0ab99c95bb7b9663b57b550feea4)
* closure é è¨­æœƒ capture (strong reference) å¤–éƒ¨è®Šæ•¸
* capture list æœƒç”Ÿæˆä¸€ä»½ copy

## Escaping å’Œ Nonescaping

* function return å¾Œé‚„æœƒç™¼ç”Ÿçš„å«åš escaping
* æœ‰æ©Ÿæœƒé€ æˆ retain cycle

## Weak å’Œ Unowned çš„é‹ä½œåŸç†

* Swift çš„ reference instance æ˜¯å€‹ HeapObject
* [HeapObject](https://github.com/apple/swift/blob/4fd0671e542299d7805e41cf9426640ab3b399af/stdlib/public/SwiftShims/HeapObject.h#L45)
* weak reference æœƒç‚º instance å»ºç«‹ side table ç”¨ä¾†è¨ˆç®—æ•¸ç›®
* [Swift Ownership Manifesto](https://github.com/apple/swift/blob/master/docs/OwnershipManifesto.md)
* [Objective-C çš„ ARC åŠŸèƒ½å¦‚æœä¸æ˜¯å› ç‚ºå‰µç«‹å…¨æ–°èªè¨€ Swift æ™‚è¿½æ±‚ memory safetyï¼Œææ€•å¾ä¾†ä¸æœƒå‡ºç¾ã€‚](https://twitter.com/ethanhuang13/status/1099200155318767616)æœ‰èˆˆè¶£çš„æœ‹å‹å¯ä»¥å»è½ [The Swift Community Podcast Ep.1](https://www.swiftcommunitypodcast.org/episodes/1)ã€‚

## ä½•æ™‚ç”¨ weak æˆ–æ˜¯ unownedï¼Ÿ

* closure ç”Ÿå‘½é€±æœŸèˆ‡å°è±¡ç”Ÿå‘½å‘¨æœŸä¸€è‡´æ™‚ï¼Œä½¿ç”¨ unowned
* weak æœ‰è¼ƒå¤šè¨˜æ†¶é«”æ¶ˆè€—
* è¦äº†è§£ç¨‹å¼ç¢¼è£¡å¤§å®¶çš„ç”Ÿå‘½å‘¨æœŸå•Š

## æŒ‘æˆ°è³½å°çµ

* closure æœƒæ•æ‰å¤–éƒ¨ä½¿ç”¨çš„è®Šæ•¸ï¼Œæœ‰å¯èƒ½é€ æˆ retain cycle
* weak å’Œ unowned æœ‰ä¸åŒçš„æ©Ÿåˆ¶èˆ‡ç”Ÿå‘½é€±æœŸ
* æ²’æœ‰ retain cycle ä¸ç”¨ weak / unowned
* weak æœ‰é¡å¤–çš„è¨˜æ†¶é«”èˆ‡æ€§èƒ½æ¶ˆè€—ï¼ˆå¯å¿½ç•¥ï¼‰

## å·¥ç¨‹å¸«çš„ escape

* [æœ€å¾Œç”Ÿé‚„è€… Part II](https://asia.playstation.com/cht-tw/games/the-last-of-us-part-ii-ps4/)

## 13 æœ€è¿‘åœ¨ç© Apple Arcade
* 13 çš„ Apple [#ArcadeReview](https://twitter.com/search?q=%23ArcadeReview%20%40ethanhuang13) é€£è¼‰ä¸­
* iPad mini è¶…é©åˆç© Apple Arcade çš„ï¼Œåˆè¼•åˆå¿«åˆå¹³ğŸ’¸

## æ­¡æ¨‚çš„æ™‚å…‰ç¸½æ˜¯éå¾—ç‰¹åˆ¥å¿«

## æ›´å¤š weak self

* ä¸»è¬›äºº [ä¸€ä¸‰](https://twitter.com/ethanhuang13)ã€[æ³¢è‚¥](https://twitter.com/PofatTseng)ã€[å–¬å–¬](https://twitter.com/joe_trash_talk)
* å®˜ç¶² [https://weakself.dev](https://weakself.dev)
* Twitter [@weak_self](https://twitter.com/weak_self)
* [æå•ç®±](https://peing.net/zh-TW/weak_self)